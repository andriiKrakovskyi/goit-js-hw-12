{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/toast-helper.js","../src/js/loader-helper.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst key = import.meta.env.VITE_API_KEY;\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(page = 1, searchWord) {\n  const { data } = await axios(BASE_URL, {\n    params: {\n      key: key,\n      q: searchWord,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page,\n    },\n  });\n\n  return data;\n}\n","export function createMarkup(items) {\n  return items\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n  <div class=\"photo__card\">\n    <a class=\"gallery__link\" \n    href=\"${largeImageURL}\"\n  >\n  <img\n    src=\"${webformatURL}\"\n    alt=\"${tags}\"\n    loading=\"lazy\"\n    class=\"webformat__img\"\n  />\n  </a>\n        <ul class=\"info\">\n          ${createInfoItem('Likes', likes)}\n          ${createInfoItem('Views', views)}\n          ${createInfoItem('Comments', comments)}\n          ${createInfoItem('Downloads', downloads)}\n        </ul>\n</div> \n`\n    )\n    .join('');\n}\n\nfunction createInfoItem(label, value) {\n  return `\n    <li class=\"list__info\">\n      <h3>${label}</h3>\n      <p>${value}</p>\n    </li>\n  `;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\niziToast.settings({\n  messageSize: '16px',\n  messageLineHeight: '24px',\n  position: 'topRight',\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n});\n\nexport function showWarning() {\n  iziToast.show({\n    message: 'Please enter a value.',\n    backgroundColor: '#f2ff00',\n    messageColor: '#2e2f42',\n  });\n}\n\nexport function showError(message) {\n  iziToast.show({\n    message: message,\n    messageColor: '#FFF',\n    backgroundColor: '#EF4040',\n    iconUrl: '../img/iconalert.svg',\n    maxWidth: '350',\n    imageWidth: '24',\n  });\n}\n","export const loader = document.querySelector('#loader');\nexport const loaderShow = document.querySelector('#loaderShow');\n\nexport function showLoader() {\n  loader.classList.remove('hidden__css');\n}\n\nexport function hideLoader() {\n  loader.classList.add('hidden__css');\n}\n\nexport function show() {\n  loaderShow.classList.remove('hidden__css');\n}\n\nexport function hide() {\n  loaderShow.classList.add('hidden__css');\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\nimport { showWarning, showError } from './js/toast-helper.js';\nimport { showLoader, hideLoader, show, hide } from './js/loader-helper.js';\n\nconst key = import.meta.env.VITE_API_KEY;\nconst BASE_URL = 'https://pixabay.com/api/';\n\nconst formSearch = document.querySelector('#myForm');\nconst gallery = document.querySelector('#gallery');\nconst loadMoreBtn = document.querySelector('#buttonLoadMore');\nconst showTheEnd = document.querySelector('.show__the__end');\nconst buttonSearch = document.querySelector('.button__search');\n\nlet lightbox = new SimpleLightbox('.gallery__link', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\nformSearch.addEventListener('submit', onFormSubmit);\nloadMoreBtn.addEventListener('click', handleClick);\n\nlet page = 0;\nlet per_page = 15;\nlet totalImages = 0;\nlet totalPages = 0;\nlet searchWord = '';\nlet cardHeight;\n\nasync function onFormSubmit(event) {\n  event.preventDefault();\n  gallery.innerHTML = '';\n  searchWord = event.target.elements.data_input.value.trim();\n  page = 1;\n  totalPages = 0;\n  hideEndMessage();\n\n  if (searchWord.length === 0) {\n    hideEndMessage();\n    showWarning();\n    hideLoadMoreButton();\n    return;\n  }\n\n  try {\n    buttonSearch.disabled = true;\n    showLoader();\n    const posts = await fetchImages(page, searchWord);\n    validateApiResponse(posts, posts.hits);\n    const hits = posts.hits;\n\n    checkHitsAndShowError(posts);\n\n    totalImages = posts.totalHits;\n    totalPages = Math.ceil(totalImages / per_page);\n\n    page++;\n\n    renderGallery(hits);\n    buttonSearch.disabled = false;\n\n    if (gallery.firstElementChild) {\n      cardHeight = gallery.firstElementChild.getBoundingClientRect().height;\n    }\n\n    if (totalPages > 1) {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    showError(error.message);\n    hideEndMessage();\n    hideLoadMoreButton();\n  } finally {\n    event.target.reset();\n    hideLoader();\n  }\n}\n\nasync function handleClick() {\n  hideLoadMoreButton();\n  loadMoreBtn.disabled = true;\n\n  try {\n    show();\n    const posts = await fetchImages(page, searchWord);\n\n    checkHitsAndShowError(posts);\n    hide();\n    renderGallery(posts.hits);\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    showLoadMoreButton();\n    page++;\n\n    if (page > totalPages) {\n      hideLoadMoreButton();\n      showEndMessage();\n      return;\n    }\n  } catch (error) {\n    showError(error.message);\n    hideEndMessage();\n    hideLoadMoreButton();\n    hide();\n  } finally {\n    loadMoreBtn.disabled = false;\n  }\n}\n\nfunction checkHitsAndShowError(response) {\n  const { hits, totalHits } = response;\n  if (totalHits === 0) {\n    throw new Error(\n      'Sorry, there are no images matching your search query. Please, try again!'\n    );\n  }\n  if (!hits || hits.length === 0) {\n    throw new Error(\n      'Unexpected error: No results found in the current page of data!'\n    );\n  }\n}\n\nfunction renderGallery(items) {\n  const markup = createMarkup(items);\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nfunction validateApiResponse(posts, hits) {\n  if (!posts || !Array.isArray(hits)) {\n    throw new Error('Invalid data structure from API');\n  }\n}\n\nfunction showLoadMoreButton() {\n  loadMoreBtn.classList.remove('button__none');\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreBtn.classList.add('button__none');\n}\n\nfunction showEndMessage() {\n  showTheEnd.classList.remove('show__the__end__none');\n}\n\nfunction hideEndMessage() {\n  showTheEnd.classList.add('show__the__end__none');\n}\n"],"names":["key","BASE_URL","fetchImages","page","searchWord","data","axios","createMarkup","items","webformatURL","largeImageURL","tags","likes","views","comments","downloads","createInfoItem","label","value","iziToast","showWarning","showError","message","loader","loaderShow","showLoader","hideLoader","show","hide","formSearch","gallery","loadMoreBtn","showTheEnd","buttonSearch","lightbox","SimpleLightbox","onFormSubmit","handleClick","per_page","totalImages","totalPages","cardHeight","event","hideEndMessage","hideLoadMoreButton","posts","validateApiResponse","hits","checkHitsAndShowError","renderGallery","showLoadMoreButton","error","showEndMessage","response","totalHits","markup"],"mappings":"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"}