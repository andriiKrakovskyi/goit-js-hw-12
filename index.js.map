{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/js/toast-helper.js","../src/js/loader-helper.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nconst key = import.meta.env.VITE_API_KEY;\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(page = 1, searchWord) {\n  const { data } = await axios(BASE_URL, {\n    params: {\n      key: key,\n      q: searchWord,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      per_page: 15,\n      page,\n    },\n  });\n  console.log(data);\n  return data;\n}\n","export function createMarkup(items) {\n  return items\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n  <div class=\"photo__card\">\n    <a class=\"gallery__link\" \n    href=\"${largeImageURL}\"\n  >\n  <img\n    src=\"${webformatURL}\"\n    alt=\"${tags}\"\n    loading=\"lazy\"\n    class=\"webformat__img\"\n  />\n  </a>\n        <ul class=\"info\">\n          ${createInfoItem('Likes', likes)}\n          ${createInfoItem('Views', views)}\n          ${createInfoItem('Comments', comments)}\n          ${createInfoItem('Downloads', downloads)}\n        </ul>\n</div> \n`\n    )\n    .join('');\n}\n\nfunction createInfoItem(label, value) {\n  return `\n    <li class=\"list__info\">\n      <h3>${label}</h3>\n      <p>${value}</p>\n    </li>\n  `;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\niziToast.settings({\n  messageSize: '16px',\n  messageLineHeight: '24px',\n  position: 'topRight',\n  transitionIn: 'flipInX',\n  transitionOut: 'flipOutX',\n});\n\nexport function showWarning() {\n  iziToast.show({\n    message: 'Please enter a value.',\n    backgroundColor: '#f2ff00',\n    messageColor: '#2e2f42',\n  });\n}\n\nexport function showError(message) {\n  iziToast.show({\n    message: message,\n    messageColor: '#FFF',\n    backgroundColor: '#EF4040',\n    iconUrl: '../img/iconalert.svg',\n    maxWidth: '350',\n    imageWidth: '24',\n  });\n}\n","export const loader = document.querySelector('#loader');\nexport const loaderShow = document.querySelector('#loaderShow');\n\nexport function showLoader() {\n  loader.classList.remove('hidden__css');\n}\n\nexport function hideLoader() {\n  loader.classList.add('hidden__css');\n}\n\nexport function show() {\n  loaderShow.classList.remove('hidden__css');\n}\n\nexport function hide() {\n  loaderShow.classList.add('hidden__css');\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './js/pixabay-api';\nimport { createMarkup } from './js/render-functions';\nimport { showWarning, showError } from './js/toast-helper.js';\nimport { showLoader, hideLoader, show, hide } from './js/loader-helper.js';\n\nconst key = import.meta.env.VITE_API_KEY;\nconst BASE_URL = 'https://pixabay.com/api/';\n\nconst formSearch = document.querySelector('#myForm');\nconst gallery = document.querySelector('#gallery');\nconst loadMoreBtn = document.querySelector('#buttonLoadMore');\nconst showTheEnd = document.querySelector('.show__the__end');\n\nlet lightbox = new SimpleLightbox('.gallery__link', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\n\nformSearch.addEventListener('submit', onFormSubmit);\nloadMoreBtn.addEventListener('click', handleClick);\n\nlet page = 0;\nlet per_page = 15;\nlet totalImages = 0;\nlet totalPages;\nlet searchWord = '';\nlet cardHeight;\n\nasync function onFormSubmit(event) {\n  event.preventDefault();\n  gallery.innerHTML = '';\n  page = 1;\n  searchWord = event.target.elements.data_input.value.trim();\n\n  if (searchWord.length === 0) {\n    hideEndMessage();\n    showWarning();\n    hideLoadMoreButton();\n    return;\n  }\n\n  try {\n    showLoader();\n    const posts = await fetchImages(page, searchWord);\n    validateApiResponse(posts, posts.hits);\n    const hits = posts.hits;\n    checkHitsAndShowError(hits);\n    totalImages = posts.totalHits;\n    totalPages = Math.ceil(totalImages / per_page);\n    page++;\n\n    renderGallery(hits);\n    cardHeight = gallery.firstElementChild.getBoundingClientRect().height;\n\n    if (page <= totalPages) {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    showError(error.message);\n    hideEndMessage();\n    hideLoadMoreButton();\n  } finally {\n    event.target.reset();\n    hideLoader();\n  }\n}\n\nasync function handleClick() {\n  console.log('totalPages', totalPages - page);\n  if (totalPages <= page) {\n    hideLoadMoreButton();\n    showEndMessage();\n    return;\n  }\n\n  hideLoadMoreButton();\n  loadMoreBtn.disabled = true;\n\n  try {\n    show();\n    const posts = await fetchImages(page, searchWord);\n\n    checkHitsAndShowError(posts.hits);\n    hide();\n    renderGallery(posts.hits);\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n    showLoadMoreButton();\n    page++;\n  } catch (error) {\n    showError(error.message);\n    hideEndMessage();\n    hideLoadMoreButton();\n  } finally {\n    loadMoreBtn.disabled = false;\n  }\n}\n\nfunction checkHitsAndShowError(hits) {\n  if (hits.length === 0) {\n    throw new Error(\n      'Sorry, there are no images matching your search query. Please, try again!'\n    );\n  }\n}\n\nfunction renderGallery(items) {\n  const markup = createMarkup(items);\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nfunction validateApiResponse(posts, hits) {\n  if (!posts || !Array.isArray(hits)) {\n    throw new Error('Invalid data structure from API');\n  }\n}\n\nfunction showLoadMoreButton() {\n  loadMoreBtn.classList.remove('button__none');\n}\n\nfunction hideLoadMoreButton() {\n  loadMoreBtn.classList.add('button__none');\n}\n\nfunction showEndMessage() {\n  showTheEnd.classList.remove('show__the__end__none');\n}\n\nfunction hideEndMessage() {\n  showTheEnd.classList.add('show__the__end__none');\n}\n"],"names":["key","BASE_URL","fetchImages","page","searchWord","data","axios","createMarkup","items","webformatURL","largeImageURL","tags","likes","views","comments","downloads","createInfoItem","label","value","iziToast","showWarning","showError","message","loader","loaderShow","showLoader","hideLoader","show","hide","formSearch","gallery","loadMoreBtn","showTheEnd","lightbox","SimpleLightbox","onFormSubmit","handleClick","per_page","totalImages","totalPages","cardHeight","event","hideEndMessage","hideLoadMoreButton","posts","validateApiResponse","hits","checkHitsAndShowError","renderGallery","showLoadMoreButton","error","showEndMessage","markup"],"mappings":"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"}